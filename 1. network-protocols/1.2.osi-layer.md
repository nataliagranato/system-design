# O Modelo OSI

O Modelo OSI (Open Systems Interconnection) √© uma estrutura conceitual que padroniza as fun√ß√µes de um sistema de comunica√ß√£o em sete camadas distintas. Cada camada tem responsabilidades espec√≠ficas e interage com as camadas adjacentes para garantir a transmiss√£o eficiente e confi√°vel de dados entre dispositivos em uma rede.

![OSI Model](https://cf-assets.www.cloudflare.com/slt3lc6tev37/6ZH2Etm3LlFHTgmkjLmkxp/59ff240fb3ebdc7794ffaa6e1d69b7c2/osi_model_7_layers.png)



## Camadas do Modelo OSI

1. **Camada F√≠sica**: Respons√°vel pela transmiss√£o de dados brutos atrav√©s do meio f√≠sico. Define caracter√≠sticas el√©tricas, mec√¢nicas e funcionais para ativar, manter e desativar a conex√£o f√≠sica. Exemplo: cabos, switches, hubs, wi-fi e etc.

![Camada F√≠sica](https://cf-assets.www.cloudflare.com/slt3lc6tev37/1HQ1W5P4XAinIdM37DTu4U/900ccdceda346baf03ce8b9f977d2974/osi_model_physical_layer_1.png)

2. **Camada de Enlace de Dados**: Garante a transfer√™ncia confi√°vel de dados entre dois dispositivos diretamente conectados. Ela detecta e corrige erros que podem ocorrer na camada f√≠sica. Exemplo: MAC Address, point-to-point protocol (PPP) e etc.

![Camada de Enlace de Dados](https://cf-assets.www.cloudflare.com/slt3lc6tev37/3TLHavXiotb9ayyZFKECf3/9456d1c431cd71ceea7f4b407f076f11/data_link_layer_osi_model.png)

3. **Camada de Rede**: Respons√°vel pelo endere√ßamento e roteamento de pacotes de dados entre dispositivos em redes diferentes. Ela determina o melhor caminho para os dados atrav√©s da rede. Exemplo: IP (Internet Protocol), ICMP (Internet Control Message Protocol), IPV4, IPV6 e etc.

![Camada de Rede](https://cf-assets.www.cloudflare.com/slt3lc6tev37/3g2Hv0frHsql5SFauJL5EG/d8cede7b6a780e63413bd86de9eee7f9/osi_model_network_layer_3.png)

4. **Camada de Transporte**: Garante a entrega confi√°vel de dados de ponta a ponta. Ela segmenta os dados em pacotes e pode fornecer controle de fluxo e recupera√ß√£o de erros. Exemplo: TCP (Transmission Control Protocol), UDP (User Datagram Protocol) e etc.

![Camada de Transporte](https://cf-assets.www.cloudflare.com/slt3lc6tev37/3OlO75NcADGL3SmEADFDqd/723b8c7639c4e2e6b4febcbe7fd36e0e/osi_model_transport_layer_4.png)

5. **Camada de Sess√£o**: Gerencia sess√µes de comunica√ß√£o entre aplicativos. Ela estabelece, mant√©m e encerra conex√µes entre processos em diferentes dispositivos. Exemplo: RPC (Remote Procedure Call), SCP (Secure Copy Protocol), Socks e etc.

![Camada de Sess√£o](https://cf-assets.www.cloudflare.com/slt3lc6tev37/29mRrgK22AqJVlg2MMlD86/34d8f4071b6cc0d3b03c93f55e4d89b7/osi_model_session_layer_5.png)

6. **Camada de Apresenta√ß√£o**: Traduz os dados entre o formato da aplica√ß√£o e o formato da rede. Ela pode realizar compress√£o, criptografia e convers√£o de dados.  Exemplo: SSL (Secure Sockets Layer), TLS (Transport Layer Security), JPEG, MPEG, GIF, ASCII, EBCDIC e etc.

![Camada de Apresenta√ß√£o](https://cf-assets.www.cloudflare.com/slt3lc6tev37/19L86neKKT8srUkOSe4rf7/ff4c91c94a1790651df7b48433913f59/osi_model_presentation_layer_6.png)

7. **Camada de Aplica√ß√£o**: Fornece servi√ßos de rede diretamente para as aplica√ß√µes do usu√°rio. Ela inclui protocolos para servi√ßos como e-mail, transfer√™ncia de arquivos e navega√ß√£o na web. Exemplo: HTTP (Hypertext Transfer Protocol), HTTPS (Hypertext Transfer Protocol Secure), FTP (File Transfer Protocol), SMTP (Simple Mail Transfer Protocol), DNS (Domain Name System), POP3, IMAP, websockets etc.

![Camada de Aplica√ß√£o](https://cf-assets.www.cloudflare.com/slt3lc6tev37/2rcDKpr4WLqoyAZ7GDKkyJ/7cab96402de7ac5465b86e617da3da4e/osi_model_application_layer_7.png)



## Fixando o Conhecimento

A grosso modo cada camada do modelo OSI serve a camada acima dela e √© servida pela camada abaixo dela. Essa estrutura em camadas facilita o design, a implementa√ß√£o e a manuten√ß√£o de sistemas de comunica√ß√£o complexos, permitindo que diferentes tecnologias e protocolos sejam integrados de maneira eficiente.

1. **Camada F√≠sica**: Transmiss√£o de dados brutos atrav√©s do meio f√≠sico, como cabos, a fibra √≥ptica e o WI-FI, s√£o os dispositivos palp√°veis. Nessa camada temos as especifica√ß√µes el√©tricas e mec√¢nicas do meio de transmiss√£o.

2. **Camada de Enlace de Dados**: Depois que ligamos os dispositivos em eletricidade, a camada de enlace de dados √© respons√°vel por garantir que os dados sejam transferidos de forma confi√°vel entre os dispositivos, sendo a primeira camada a lidar com a recep√ß√£o e transmiss√£o de dados. Ela faz isso detectando e corrigindo erros que podem ocorrer na camada f√≠sica.

3. **Camada de Rede**: Respons√°vel pelo endere√ßamento e roteamento de pacotes de dados entre dispositivos em redes diferentes, determinando o melhor caminho para os dados atrav√©s da rede. √â o endere√ßamento l√≥gico (IP), ele controla o tr√°fego na rede, roteia os pacotes e lida com a fragmenta√ß√£o e remontagem dos pacotes de dados.

4. **Camada de Transporte**: Aqui encontramos protocolos mais pr√≥ximos do desenvolvedor, o TCP e o UDP, que s√£o amplamente utilizados em aplica√ß√µes de rede. Garante a transfer√™ncia confi√°vel de dados entre dois dispositivos diretamente conectados, detectando e corrigindo erros que podem ocorrer na camada f√≠sica.

5. **Camada de Sess√£o**: Gerencia sess√µes de comunica√ß√£o entre aplicativos, estabelecendo, mantendo e encerrando conex√µes entre processos em diferentes dispositivos.

6. **Camada de Apresenta√ß√£o**: Traduz os dados entre o formato da aplica√ß√£o e o formato da rede, realizando compress√£o, criptografia e convers√£o de dados.

7. **Camada de Aplica√ß√£o**: √â a camada mais pr√≥xima do usu√°rio. Fornece servi√ßos de rede diretamente para as aplica√ß√µes do usu√°rio, incluindo protocolos para servi√ßos como e-mail, transfer√™ncia de arquivos e navega√ß√£o na web.

## Comandos Pr√°ticos por Camada OSI

### üîß **Camada 1 - F√≠sica**
```bash
# Verificar interfaces de rede f√≠sicas dispon√≠veis
ip link show

# Verificar status das interfaces (up/down)
ifconfig -a

# Verificar estat√≠sticas de tr√°fego da interface
cat /proc/net/dev

# Verificar informa√ß√µes detalhadas da interface ethernet
ethtool eth0
```

### üîó **Camada 2 - Enlace de Dados**
```bash
# Exibir tabela ARP (mapeamento IP -> MAC)
arp -a
# Exemplo de sa√≠da:
# ? (192.168.18.1) at e0:da:90:4c:a5:50 on en5 [ethernet]
# ? (192.168.18.189) at 0:e0:4c:9f:6f:c3 on en5 [ethernet]

# Verificar endere√ßo MAC da pr√≥pria m√°quina
ip link show | grep ether

# Capturar frames ethernet (requer sudo)
tcpdump -i en0 -e

# Verificar bridge/switch virtual (se existir)
brctl show
```

### üåê **Camada 3 - Rede**
```bash
# Verificar endere√ßos IP configurados
ip addr show
# ou
ifconfig

# Verificar tabela de roteamento
ip route show
# ou
route -n

# Testar conectividade (ICMP)
ping 8.8.8.8

# Rastrear rota at√© destino
traceroute google.com
# ou no macOS/Windows:
traceroute google.com

# Verificar informa√ß√µes de DNS
nslookup google.com
```

### üöö **Camada 4 - Transporte**
```bash
# Verificar portas TCP/UDP abertas
netstat -tuln
# ou
ss -tuln

# Verificar conex√µes TCP estabelecidas
netstat -t
# ou
ss -t

# Testar conectividade em porta espec√≠fica
telnet google.com 80
# ou
nc -zv google.com 80

# Verificar estat√≠sticas TCP/UDP
cat /proc/net/tcp
cat /proc/net/udp
```

### üí¨ **Camada 5 - Sess√£o**
```bash
# Verificar sess√µes SSH ativas
who
# ou
w

# Verificar processos de rede ativos
lsof -i

# Verificar conex√µes por processo
lsof -i -P

# Verificar sess√µes de usu√°rio
last
```

### üîí **Camada 6 - Apresenta√ß√£o**
```bash
# Testar conex√£o SSL/TLS
openssl s_client -connect google.com:443

# Verificar certificado SSL
openssl s_client -connect google.com:443 -showcerts

# Verificar algoritmos de criptografia suportados
openssl ciphers -v

# Verificar informa√ß√µes de certificado
echo | openssl s_client -connect google.com:443 2>/dev/null | openssl x509 -noout -text
```

### üì± **Camada 7 - Aplica√ß√£o**
```bash
# Requisi√ß√£o HTTP simples
curl -I http://google.com

# Requisi√ß√£o HTTP com detalhes
curl -v http://httpbin.org/get

# Testar DNS
dig google.com
# ou
nslookup google.com

# Enviar email via telnet (SMTP)
telnet smtp.gmail.com 587

# Baixar arquivo via FTP
wget ftp://ftp.exemplo.com/arquivo.txt

# Requisi√ß√£o HTTP com cabe√ßalhos personalizados
curl -H "User-Agent: MeuApp/1.0" http://httpbin.org/headers
```

### üîç **Comandos de An√°lise Geral**
```bash
# Capturar todo tr√°fego de rede
sudo tcpdump -i any -w captura.pcap

# Analisar captura com filtros
tcpdump -r captura.pcap -n host 8.8.8.8

# Verificar largura de banda em tempo real
iftop
# ou
nethogs

# Monitor completo de rede
wireshark
# ou via terminal:
tshark -i en0
```

### üìã **Interpretando os Resultados**

#### **Exemplo: Comando `arp -a`**
```bash
‚ùØ arp -a
? (169.254.169.254) at (incomplete) on en5 [ethernet]
? (192.168.18.1) at e0:da:90:4c:a5:50 on en5 [ethernet]
? (192.168.18.189) at 0:e0:4c:9f:6f:c3 on en5 [ethernet]
```
**Explica√ß√£o:**
- `192.168.18.1` = IP do gateway/roteador
- `e0:da:90:4c:a5:50` = Endere√ßo MAC f√≠sico do roteador
- `en5` = Interface de rede local
- `[ethernet]` = Tipo de conex√£o f√≠sica

#### **Exemplo: Comando `ip route show`**
```bash
‚ùØ ip route show
default via 192.168.18.1 dev en5
192.168.18.0/24 dev en5 scope link
```
**Explica√ß√£o:**
- `default via 192.168.18.1` = Todo tr√°fego n√£o-local vai para este gateway
- `192.168.18.0/24` = Rede local (256 endere√ßos poss√≠veis)
- `dev en5` = Interface de sa√≠da

#### **Exemplo: Comando `netstat -tuln`**
```bash
‚ùØ netstat -tuln
Proto Recv-Q Send-Q Local Address    Foreign Address    State
tcp4  0      0      127.0.0.1.3000   *.*                LISTEN
tcp4  0      0      *.22             *.*                LISTEN
```
**Explica√ß√£o:**
- `tcp4` = Protocolo IPv4 TCP
- `127.0.0.1.3000` = Servidor local na porta 3000
- `*.22` = SSH server ouvindo em todas as interfaces
- `LISTEN` = Aguardando conex√µes

## Materiais Relacionados
- [Introdu√ß√£o a Protocolos de Rede](./introduction-to-protocols.md)

- O simulador de [Cisco Packet Tracer](https://www.netacad.com/pt/cisco-packet-tracer)
- O analisador de pacotes [Wireshark](https://www.wireshark.org/)
- O cliente HTTP [Postman](https://www.postman.com/)
- O cliente HTTP CLI [HTTPie](https://httpie.io/)
- O emulador de redes [GNS3](https://gns3.com/)
- RFC Editor da [IETF](https://www.rfc-editor.org/)
- HTTP Cats (https://http.cat/)
- HTTP Status Dogs (https://httpstatusdogs.com/)
- HTTP Status Codes (https://httpstatus.com.br/)
- O livro [Redes de Computadores - Tanenbaum](https://www.amazon.com.br/Redes-Computadores-Andrew-Tanenbaum/dp/8582605609)

## Refer√™ncias

- Gloss√°rio da [Cloudflare sobre modelo OSI](https://www.cloudflare.com/pt-br/learning/ddos/glossary/open-systems-interconnection-model-osi/)

- Curso da LINUXtios sobre [Descomplicando o System Design](https://github.com/msfidelis/linuxtips-curso-descomplicando-o-system-design)
